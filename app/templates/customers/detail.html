{% extends "base.html" %}
{% block title %}Customer {{ customer.name }}{% endblock %}
{% block content %}
<div class="page-header d-flex flex-wrap justify-content-between align-items-center gap-2 mb-3">
  <h1 class="h4 mb-0"><i class="bi bi-person me-2"></i>{{ customer.name }}</h1>
  <div class="d-flex gap-2">
    <a href="{{ url_for('customers.customer_edit', customer_id=customer.id) }}" class="btn btn-primary btn-sm">Edit</a>
    <a href="{{ url_for('customers.customer_list') }}" class="btn btn-outline-secondary btn-sm">Back to list</a>
  </div>
</div>
<div class="card p-3 mb-3">
  <div class="row small">
    <div class="col-md-4"><span class="text-muted">Email</span><br>{{ customer.email or '-' }}</div>
    <div class="col-md-4"><span class="text-muted">Phone</span><br>{{ customer.phone or '-' }}</div>
    <div class="col-md-4"><span class="text-muted">Loyalty points</span><br><span class="badge bg-primary rounded-pill">{{ customer.loyalty_points }}</span></div>
  </div>
</div>
<div class="card overflow-hidden">
  <div class="card-header">Purchase history</div>
  <div class="table-responsive">
    <table class="table table-hover align-middle mb-0">
      <thead class="table-light"><tr><th>Sale ID</th><th>Date</th><th>Total</th><th>Payment</th><th class="text-end">Receipt</th></tr></thead>
      <tbody>
        {% for s in sales %}
        <tr><td><strong>{{ s.id }}</strong></td><td>{{ s.created_at.strftime('%Y-%m-%d %H:%M') if s.created_at else '-' }}</td><td>{{ s.total }}</td><td>{{ s.payment_method }}</td><td class="text-end"><a href="{{ url_for('pos.receipt', sale_id=s.id) }}" class="btn btn-sm btn-outline-primary">View</a></td></tr>
        {% else %}
        <tr><td colspan="5" class="text-muted text-center py-4">No sales.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
