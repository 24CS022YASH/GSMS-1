{% extends "base.html" %}
{% block title %}Analytics{% endblock %}
{% block content %}
<div class="page-header mb-3">
  <h1 class="h4 mb-0"><i class="bi bi-graph-up me-2"></i>Analytics</h1>
</div>
{% include "includes/analytics_nav.html" %}
<form method="get" class="card p-3 mb-3">
  <div class="row g-2 align-items-end">
    <div class="col-auto"><label class="form-label small mb-0">From</label><input type="date" name="start" class="form-control form-control-sm" value="{{ start_date }}"></div>
    <div class="col-auto"><label class="form-label small mb-0">To</label><input type="date" name="end" class="form-control form-control-sm" value="{{ end_date }}"></div>
    <div class="col-auto"><button type="submit" class="btn btn-primary btn-sm">Apply</button></div>
  </div>
</form>
<div class="row g-3 mb-4">
  <div class="col-6 col-md-3"><div class="card h-100"><div class="card-body"><h6 class="text-muted small text-uppercase fw-semibold mb-1">Total sales</h6><p class="h5 mb-0 fw-bold">{{ summary.total_sales }}</p></div></div></div>
  <div class="col-6 col-md-3"><div class="card h-100"><div class="card-body"><h6 class="text-muted small text-uppercase fw-semibold mb-1">Transactions</h6><p class="h5 mb-0 fw-bold">{{ summary.transaction_count }}</p></div></div></div>
  <div class="col-6 col-md-3"><div class="card h-100"><div class="card-body"><h6 class="text-muted small text-uppercase fw-semibold mb-1">Tax</h6><p class="h5 mb-0 fw-bold">{{ summary.total_tax }}</p></div></div></div>
  <div class="col-6 col-md-3"><div class="card h-100"><div class="card-body"><h6 class="text-muted small text-uppercase fw-semibold mb-1">Discount</h6><p class="h5 mb-0 fw-bold">{{ summary.total_discount }}</p></div></div></div>
</div>
<div class="row g-3">
  <div class="col-md-6">
    <div class="card"><div class="card-header">Daily sales</div><div class="card-body p-0"><div class="table-responsive"><table class="table table-sm table-hover mb-0"><thead class="table-light"><tr><th>Date</th><th>Total</th><th>Count</th></tr></thead><tbody>{% for r in daily %}<tr><td>{{ r.period }}</td><td>{{ r.total_sales }}</td><td>{{ r.count }}</td></tr>{% endfor %}</tbody></table></div></div></div>
  </div>
  <div class="col-md-6">
    <div class="card"><div class="card-header">Best selling (top 10)</div><div class="card-body p-0"><ul class="list-group list-group-flush">{% for b in best_selling %}<li class="list-group-item d-flex justify-content-between align-items-center"><span>{{ b.name }}</span><span class="badge bg-primary rounded-pill">{{ b.quantity_sold }} sold</span></li>{% endfor %}</ul></div></div>
  </div>
</div>
<div class="mt-3 d-flex flex-wrap gap-2">
  <a href="{{ url_for('analytics.sales_report_page') }}" class="btn btn-outline-primary btn-sm"><i class="bi bi-receipt me-1"></i>Sales report</a>
  <a href="{{ url_for('analytics.inventory_report') }}" class="btn btn-outline-primary btn-sm"><i class="bi bi-clipboard-data me-1"></i>Inventory report</a>
  <a href="{{ url_for('analytics.export_csv') }}" class="btn btn-outline-secondary btn-sm"><i class="bi bi-file-earmark-text me-1"></i>Export CSV</a>
  <a href="{{ url_for('analytics.export_excel') }}" class="btn btn-outline-secondary btn-sm"><i class="bi bi-file-earmark-excel me-1"></i>Export Excel</a>
  <a href="{{ url_for('analytics.export_pdf') }}" class="btn btn-outline-secondary btn-sm"><i class="bi bi-file-earmark-pdf me-1"></i>Export PDF</a>
</div>
{% endblock %}
